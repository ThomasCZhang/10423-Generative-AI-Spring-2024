
tokens per iteration will be: 32,768
Map: 100%|███████████████████████████████████████████████████████| 4000/4000 [00:00<00:00, 5820.88 examples/s]
Map: 100%|███████████████████████████████████████████████████████| 1000/1000 [00:00<00:00, 4949.41 examples/s]
Initializing from OpenAI GPT-2 weights: gpt2-medium
loading weights from pretrained gpt: gpt2-medium
forcing vocab_size=50257, block_size=1024, bias=True
overriding dropout rate to 0.0
overriding lora_rank and lora_alpha to 16
overriding lora_dropout to 0.05
number of parameters: 356.13M
num decayed parameter tensors: 96, with 2,359,296 parameters
num non-decayed parameter tensors: 0, with 0 parameters
using fused AdamW: True
C:\Users\tzhan\PythonWS\10423_Spring2024\hw3\handout\model.py:88: UserWarning: 1Torch was not compiled with flash attention. (Triggered internally at ..\aten\src\ATen\native\transformers\cuda\sdp_utils.cpp:263.)
  y = torch.nn.functional.scaled_dot_product_attention(q, k, v, attn_mask=None, dropout_p=self.dropout if self.training else 0, is_causal=True)
step 0: train loss 4.7054, val loss 4.7394
iter 0: loss 4.3185, time 11130.76ms, mfu -100.00%
iter 1: loss 4.1140, time 4400.03ms, mfu -100.00%
iter 2: loss 3.9083, time 4388.98ms, mfu -100.00%
iter 3: loss 3.0866, time 4469.49ms, mfu -100.00%
iter 4: loss 3.0620, time 4458.62ms, mfu -100.00%
step 5: train loss 2.7864, val loss 2.8878
saving checkpoint to gpt-default-lora-16-64
iter 5: loss 2.4067, time 12884.35ms, mfu 1.99%
iter 6: loss 2.4793, time 4412.52ms, mfu 2.37%
iter 7: loss 2.5887, time 4497.63ms, mfu 2.70%
iter 8: loss 2.3681, time 4444.22ms, mfu 3.01%
iter 9: loss 1.3601, time 4407.55ms, mfu 3.29%
step 10: train loss 1.9347, val loss 1.8900
saving checkpoint to gpt-default-lora-16-64
iter 10: loss 2.8213, time 12747.53ms, mfu 3.16%
iter 11: loss 2.0940, time 4494.03ms, mfu 3.41%
iter 12: loss 1.6198, time 4443.12ms, mfu 3.65%
iter 13: loss 2.3984, time 4447.03ms, mfu 3.86%
iter 14: loss 1.6173, time 4448.15ms, mfu 4.05%
step 15: train loss 1.6404, val loss 1.5350
saving checkpoint to gpt-default-lora-16-64
iter 15: loss 2.8276, time 12926.00ms, mfu 3.84%
iter 16: loss 1.3417, time 4381.14ms, mfu 4.04%
iter 17: loss 0.8243, time 4375.12ms, mfu 4.22%
iter 18: loss 1.6603, time 4504.69ms, mfu 4.37%
iter 19: loss 1.7970, time 4510.19ms, mfu 4.50%
step 20: train loss 1.5343, val loss 1.4997
saving checkpoint to gpt-default-lora-16-64
iter 20: loss 0.6998, time 13033.22ms, mfu 4.25%
iter 21: loss 1.5598, time 4473.02ms, mfu 4.40%
iter 22: loss 1.0953, time 4462.36ms, mfu 4.53%
iter 23: loss 1.5975, time 4447.59ms, mfu 4.65%
iter 24: loss 0.6994, time 4446.99ms, mfu 4.76%
step 25: train loss 1.4586, val loss 1.4409
saving checkpoint to gpt-default-lora-16-64
iter 25: loss 0.6651, time 13323.37ms, mfu 4.48%
iter 26: loss 1.1760, time 4472.37ms, mfu 4.60%
iter 27: loss 1.2615, time 4417.84ms, mfu 4.72%
iter 28: loss 1.5219, time 4504.88ms, mfu 4.82%
iter 29: loss 1.5101, time 4456.96ms, mfu 4.91%
step 30: train loss 1.4023, val loss 1.3410
saving checkpoint to gpt-default-lora-16-64
iter 30: loss 0.8490, time 13155.44ms, mfu 4.62%
iter 31: loss 1.4227, time 4478.83ms, mfu 4.73%
iter 32: loss 1.2711, time 4521.78ms, mfu 4.82%
iter 33: loss 0.7257, time 4482.56ms, mfu 4.91%
iter 34: loss 1.0343, time 4521.91ms, mfu 4.99%
step 35: train loss 1.3809, val loss 1.4609
iter 35: loss 1.7636, time 9873.00ms, mfu 4.75%
iter 36: loss 1.2835, time 4486.00ms, mfu 4.84%
iter 37: loss 1.9059, time 4514.37ms, mfu 4.93%
iter 38: loss 1.7233, time 4409.36ms, mfu 5.01%
iter 39: loss 1.2663, time 4580.24ms, mfu 5.07%
step 40: train loss 1.6226, val loss 1.4015
iter 40: loss 0.7439, time 9841.88ms, mfu 4.82%
iter 41: loss 1.2808, time 4466.56ms, mfu 4.92%
iter 42: loss 1.5452, time 4448.25ms, mfu 5.00%
iter 43: loss 1.0077, time 4478.86ms, mfu 5.07%
iter 44: loss 1.1936, time 4514.37ms, mfu 5.13%
step 45: train loss 1.2851, val loss 1.3401
saving checkpoint to gpt-default-lora-16-64
iter 45: loss 1.7335, time 12955.41ms, mfu 4.82%
iter 46: loss 1.1143, time 4410.90ms, mfu 4.92%
iter 47: loss 1.6271, time 4383.76ms, mfu 5.01%
iter 48: loss 1.5140, time 4431.94ms, mfu 5.09%
iter 49: loss 0.9461, time 4442.17ms, mfu 5.15%
step 50: train loss 1.3662, val loss 1.3303
saving checkpoint to gpt-default-lora-16-64
iter 50: loss 1.1498, time 12724.97ms, mfu 4.84%