dataset length: 5153, dataset class: cat
 torch.Size([32, 3, 32, 32])
steps:   0%|                                                                            | 0/1 [00:00<?, ?it/s]
steps: 100%|████████████████████████████████████████████████████████████████████| 1/1 [00:04<00:00,  4.84s/it]
Traceback (most recent call last):
  File "C:\Users\tzhan\PythonWS\10423_Spring2024\hw2\handout\main.py", line 104, in <module>
    trainer.train()
  File "C:\Users\tzhan\PythonWS\10423_Spring2024\hw2\handout\trainer.py", line 220, in train
    images = self.model.sample(self.batch_size)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\tzhan\PythonWS\10423_Spring2024\venv\Lib\site-packages\torch\utils\_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\tzhan\PythonWS\10423_Spring2024\hw2\handout\diffusion.py", line 186, in sample
    img = self.p_sample_loop(img)
          ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\tzhan\PythonWS\10423_Spring2024\venv\Lib\site-packages\torch\utils\_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\tzhan\PythonWS\10423_Spring2024\hw2\handout\diffusion.py", line 168, in p_sample_loop
    img = self.p_sample(img, torch.full((b, ) , t, device = device), t)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\tzhan\PythonWS\10423_Spring2024\venv\Lib\site-packages\torch\utils\_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\tzhan\PythonWS\10423_Spring2024\hw2\handout\diffusion.py", line 147, in p_sample
    sigma = extract(self.sigmas, t_index, x.shape)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\tzhan\PythonWS\10423_Spring2024\hw2\handout\diffusion.py", line 27, in extract
    b, *_ = t.shape
            ^^^^^^^
AttributeError: 'int' object has no attribute 'shape'